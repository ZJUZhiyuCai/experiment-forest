import { SOPTemplate } from '@/types';

/**
 * 生命医药领域通用SOP模板
 * 包含常用的实验操作程序标准
 */
export const sopTemplates: SOPTemplate[] = [
  {
    id: 'sop-cell-culture-001',
    title: '细胞培养标准操作程序',
    category: 'cell_culture',
    version: '1.0',
    author: '实验室管理员',
    department: '细胞生物学实验室',
    purpose: '规范细胞培养的操作流程，确保细胞培养的无菌性和一致性',
    scope: '适用于所有体外细胞培养操作',
    content: `# 细胞培养标准操作程序

## 1. 目的
建立标准化的细胞培养操作程序，确保实验结果的可重复性和细胞培养的安全性。

## 2. 适用范围
适用于所有体外培养的哺乳动物细胞系。

## 3. 材料与设备
### 3.1 设备
- 生物安全柜（II级）
- CO2恒温培养箱
- 倒置显微镜
- 离心机
- 移液器（1-1000μL）

### 3.2 试剂
- 完全培养基（根据细胞系要求配制）
- PBS缓冲液（无钙镁）
- 胰蛋白酶-EDTA溶液
- 细胞冻存液

## 4. 操作步骤
### 4.1 传代培养
1. 在生物安全柜内操作，确保无菌环境
2. 预热培养基至37°C
3. 吸除旧培养基
4. 用PBS洗涤细胞2次，每次5mL
5. 加入1-2mL胰酶消化3-5分钟
6. 加入5mL完全培养基终止消化
7. 轻柔吹打混匀，制备细胞悬液
8. 按1:3-1:6比例分种至新培养瓶
9. 置于37°C，5% CO2培养箱培养

### 4.2 细胞计数
1. 取100μL细胞悬液
2. 加入100μL台盼蓝染料
3. 使用血细胞计数板计数
4. 活细胞率应>95%

## 5. 质量控制
- 培养基pH应在7.2-7.4之间
- 细胞形态正常，无污染迹象
- 传代后24小时内细胞应贴壁生长
- 定期进行支原体检测

## 6. 记录要求
- 记录传代日期、时间
- 记录细胞密度和活力
- 记录培养基批号
- 记录异常情况

## 7. 注意事项
- 严格执行无菌操作
- 避免频繁开关培养箱门
- 定期清洁生物安全柜
- 及时处理细胞培养废料`,
    isTemplate: true,
    templateTags: ['细胞培养', '无菌操作', '传代', '质量控制']
  },

  {
    id: 'sop-pcr-001',
    title: 'PCR扩增标准操作程序',
    category: 'pcr',
    version: '1.0',
    author: '实验室管理员',
    department: '分子生物学实验室',
    purpose: '建立标准化的PCR扩增操作程序，确保PCR实验的准确性和重现性',
    scope: '适用于所有常规PCR扩增实验',
    content: `# PCR扩增标准操作程序

## 1. 目的
建立标准化的PCR扩增操作程序，确保PCR实验结果的准确性、特异性和重现性。

## 2. 适用范围
适用于基因扩增、基因型检测、载体构建等PCR相关实验。

## 3. 材料与设备
### 3.1 设备
- PCR仪
- 微量离心机
- 微量移液器（0.5-200μL）
- 涡旋混合器
- 冰盒

### 3.2 试剂
- Taq DNA聚合酶
- 10×PCR缓冲液
- dNTP混合液（各2.5mM）
- 引物（正向和反向）
- DNA模板
- 无菌水

## 4. 操作步骤
### 4.1 反应体系配制（25μL体系）
| 组分 | 体积 | 终浓度 |
|------|------|--------|
| 10×PCR缓冲液 | 2.5μL | 1× |
| dNTP混合液 | 2.0μL | 200μM |
| 正向引物 | 1.0μL | 0.4μM |
| 反向引物 | 1.0μL | 0.4μM |
| Taq酶 | 0.2μL | 1.25U |
| DNA模板 | 1.0μL | 10-100ng |
| 无菌水 | 17.3μL | - |
| 总体积 | 25μL | - |

### 4.2 PCR程序设置
1. 初始变性：95°C，5分钟
2. 循环反应（30-35个循环）：
   - 变性：95°C，30秒
   - 退火：55-65°C，30秒（根据引物Tm值调整）
   - 延伸：72°C，1分钟/kb
3. 最终延伸：72°C，10分钟
4. 保存：4°C

### 4.3 产物检测
1. 配制1.5%琼脂糖凝胶
2. 取5μL PCR产物进行电泳
3. 电泳条件：120V，30分钟
4. 紫外灯下观察结果

## 5. 质量控制
- 设置阴性对照（无模板对照）
- 设置阳性对照（已知阳性模板）
- 引物特异性检验
- 产物大小确认

## 6. 结果判定
- 目标条带清晰，大小正确
- 阴性对照无扩增产物
- 阳性对照有预期产物

## 7. 注意事项
- 避免DNA模板降解
- 防止交叉污染
- 引物储存于-20°C
- 严格控制退火温度`,
    isTemplate: true,
    templateTags: ['PCR', '基因扩增', '分子生物学', '质量控制']
  },

  {
    id: 'sop-western-blot-001',
    title: 'Western Blot检测标准操作程序',
    category: 'western_blot',
    version: '1.0',
    author: '实验室管理员',
    department: '蛋白质研究实验室',
    purpose: '建立标准化的Western Blot检测流程，确保蛋白质检测的准确性',
    scope: '适用于各种蛋白质的免疫印迹检测',
    content: `# Western Blot检测标准操作程序

## 1. 目的
建立标准化的Western Blot操作程序，确保蛋白质检测的特异性、敏感性和重现性。

## 2. 适用范围
适用于细胞、组织中目标蛋白的定性和半定量检测。

## 3. 材料与设备
### 3.1 设备
- 蛋白电泳仪
- 转膜仪
- 化学发光成像系统
- 摇床
- 高速离心机

### 3.2 试剂
- 蛋白裂解液（RIPA）
- SDS-PAGE预制胶
- 蛋白标准品
- 转膜缓冲液
- 封闭液（5%脱脂奶粉）
- 一抗、二抗
- ECL发光试剂

## 4. 操作步骤
### 4.1 蛋白提取
1. 细胞用冰冷PBS洗涤2次
2. 加入适量RIPA裂解液
3. 4°C裂解30分钟，期间涡旋3次
4. 12000rpm离心15分钟，取上清
5. Bradford法测定蛋白浓度

### 4.2 SDS-PAGE电泳
1. 样品与上样缓冲液1:1混合
2. 100°C煮沸5分钟变性
3. 上样量20-50μg蛋白
4. 电泳条件：80V 30分钟，120V 60分钟

### 4.3 转膜
1. 凝胶浸泡在转膜缓冲液中5分钟
2. PVDF膜用甲醇活化1分钟
3. 湿转条件：100V，60分钟，4°C
4. 丽春红染色确认转膜效果

### 4.4 免疫检测
1. 5%脱脂奶粉室温封闭1小时
2. 一抗4°C孵育过夜（稀释比例1:1000-1:5000）
3. TBST洗涤3次，每次10分钟
4. 二抗室温孵育1小时（稀释比例1:5000-1:10000）
5. TBST洗涤3次，每次10分钟
6. ECL显影，化学发光检测

## 5. 质量控制
- 蛋白浓度测定重复3次
- 设置内参对照（β-actin, GAPDH等）
- 设置阳性和阴性对照
- 蛋白标准品验证分子量

## 6. 结果分析
- 目标条带清晰，无非特异性条带
- 分子量与预期相符
- 内参条带一致
- 可进行半定量分析

## 7. 注意事项
- 蛋白样品避免反复冻融
- 严格控制孵育时间和温度
- 抗体按说明书稀释使用
- 及时处理废液`,
    isTemplate: true,
    templateTags: ['Western Blot', '蛋白检测', '免疫印迹', '质量控制']
  },

  {
    id: 'sop-elisa-001',
    title: 'ELISA检测标准操作程序',
    category: 'elisa',
    version: '1.0',
    author: '实验室管理员',
    department: '免疫学实验室',
    purpose: '建立标准化的ELISA检测流程，确保免疫检测的准确性和精密度',
    scope: '适用于各种抗原、抗体、细胞因子的ELISA检测',
    content: `# ELISA检测标准操作程序

## 1. 目的
建立标准化的ELISA检测操作程序，确保免疫检测结果的准确性、精密度和可重现性。

## 2. 适用范围
适用于血清、血浆、细胞培养上清、组织匀浆等样品中目标分子的定量检测。

## 3. 材料与设备
### 3.1 设备
- 酶标仪
- 96孔酶标板
- 多道移液器
- 恒温摇床
- 洗板机

### 3.2 试剂
- ELISA试剂盒
- 标准品
- 样品稀释液
- 洗涤液
- 底物溶液
- 终止液

## 4. 操作步骤
### 4.1 样品准备
1. 样品解冻至室温
2. 按说明书要求稀释样品
3. 离心去除沉淀
4. 样品应在2小时内检测完毕

### 4.2 标准曲线制备
1. 用样品稀释液将标准品进行系列稀释
2. 建议设置7-8个浓度点
3. 每个浓度点设置双孔
4. 设置空白对照

### 4.3 ELISA检测流程
1. 加样：标准品和样品各100μL/孔
2. 室温孵育2小时或4°C过夜
3. 洗板3次，每次浸泡1分钟
4. 加入生物素化抗体100μL/孔
5. 室温孵育1小时
6. 洗板3次
7. 加入酶标记亲和素100μL/孔
8. 室温孵育30分钟
9. 洗板3次
10. 加入底物液100μL/孔
11. 室温避光反应15-30分钟
12. 加入终止液50μL/孔
13. 450nm波长下测定吸光度

### 4.4 数据处理
1. 计算标准品的平均吸光度
2. 用标准品浓度和吸光度作标准曲线
3. 根据标准曲线计算样品浓度
4. 计算变异系数（CV%）

## 5. 质量控制
- 标准曲线相关系数R²>0.99
- 板内CV<10%，板间CV<15%
- 空白对照OD值<0.1
- 阳性对照在预期范围内

## 6. 结果判定
- 标准曲线线性良好
- 质控样品在可接受范围内
- 样品检测结果符合预期

## 7. 注意事项
- 试剂盒使用前平衡至室温
- 严格按照说明书操作
- 避免产生气泡
- 注意反应时间控制
- 样品避免反复冻融`,
    isTemplate: true,
    templateTags: ['ELISA', '免疫检测', '定量分析', '质量控制']
  },

  {
    id: 'sop-animal-dosing-001',
    title: '动物给药标准操作程序',
    category: 'animal_dosing',
    version: '1.0',
    author: '实验室管理员',
    department: '动物实验中心',
    purpose: '规范动物给药操作，确保给药的准确性和动物福利',
    scope: '适用于各种实验动物的药物给药操作',
    content: `# 动物给药标准操作程序

## 1. 目的
建立标准化的动物给药操作程序，确保给药剂量的准确性，保障动物福利，获得可靠的实验数据。

## 2. 适用范围
适用于小鼠、大鼠等实验动物的口服、注射等给药操作。

## 3. 材料与设备
### 3.1 设备
- 精密天平
- 注射器（各种规格）
- 动物保定器
- 灌胃针
- 消毒用品

### 3.2 试剂
- 受试药物
- 溶媒（生理盐水、植物油等）
- 消毒酒精
- 动物麻醉剂（如需要）

## 4. 操作步骤
### 4.1 给药前准备
1. 称重记录动物体重
2. 根据体重计算给药剂量
3. 配制药物溶液
4. 标记动物编号
5. 准备给药器具

### 4.2 口服给药（灌胃）
1. 用保定器固定动物
2. 将灌胃针插入口腔，沿左侧壁缓慢推进
3. 确认针头在胃内（无阻力）
4. 缓慢注入药液
5. 拔出灌胃针，观察动物状态
6. 记录给药时间和剂量

### 4.3 腹腔注射
1. 固定动物，暴露腹部
2. 选择注射部位（腹部右下象限）
3. 消毒注射部位
4. 以30-45°角度刺入
5. 回抽确认无血液
6. 缓慢注射药液
7. 拔针并轻压止血

### 4.4 静脉注射（尾静脉）
1. 加温或理疗使血管扩张
2. 固定动物尾部
3. 消毒注射部位
4. 针头平行尾静脉刺入
5. 见回血后缓慢注射
6. 拔针并压迫止血

## 5. 质量控制
- 给药剂量误差<5%
- 给药时间准确记录
- 观察动物给药后反应
- 记录异常情况

## 6. 观察指标
- 动物一般状态
- 体重变化
- 食欲、饮水情况
- 异常行为或症状

## 7. 注意事项
- 严格按照动物伦理要求操作
- 确保给药剂量准确
- 避免给药过程中的应激
- 及时处理异常情况
- 完整记录实验数据

## 8. 记录要求
- 动物编号、性别、体重
- 给药日期、时间
- 药物名称、剂量、给药途径
- 动物反应和异常情况`,
    isTemplate: true,
    templateTags: ['动物实验', '给药', '药代动力学', '动物福利']
  }
];

/**
 * 根据实验类型获取相关的SOP模板
 */
export function getSOPTemplatesByCategory(category: string): SOPTemplate[] {
  return sopTemplates.filter(template => template.category === category);
}

/**
 * 获取所有SOP模板的分类
 */
export function getSOPTemplateCategories(): string[] {
  return [...new Set(sopTemplates.map(template => template.category))];
}

/**
 * 根据ID获取SOP模板
 */
export function getSOPTemplateById(id: string): SOPTemplate | undefined {
  return sopTemplates.find(template => template.id === id);
}